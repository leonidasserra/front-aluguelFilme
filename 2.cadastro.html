<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="style.css">
    <meta charset="UTF-8" />
    <title>Cadastro</title>
</head>

    <!-- Sidebar -->
<div class="sidebar">
    <ul>
        <a href="3.telaInicial.html">Home</a>
        <br>
        <a href="5.pessoas.html">Ver Clientes</a>
        <br>
        <a href="2.cadastro.html">Novo Cliente</a>
        <br>
        <a href="6.novoFilme.html">Novo Filme</a>
        <br>
        <a href="javascript:history.back()">Voltar</a>
        <br>
        <a href="1.login.html" id="exit-btn">Sair</a>
    </ul>
</div>

<body>
 

    <div class="main-content-signup">
           <h1>Cadastro</h1>
        <div class="inner-content-signup">
            <form action="1.login.html" method="get">
                <div class="section-signup">
                    <label for="nome">Nome</label>
                    <input type="text" id="nomeCad" name="nomeCad" required>
                </div>

                    <br><br>

                <div class="section-signup">
                    <label for="cpf">Cpf</label>
                    <input type="text" id="cpfCad" name="cpf" maxlength="14" required>
                </div>

                    <br><br>

                <div class="section-signup">
                    <label for="numero">NÃºmero</label>
                    <input type="tel" id="numeroCad" name="numeroCad" required>
                </div>

                
                    <br><br>

                 <div class="section-signup">
                    <label for="nascimento">Nascimento</label>
                    <input type="date" id="nascCad" name="nascCad" min="1900-01-01" required>
                </div>
                
                    <br><br>   
               
                    <div class="section-signup">
                    <label for="email">Email</label>
                    <input type="email" id="emailCad" name="emailCad" required>
                </div>
                
                    <br><br>   
                

                <div class="section-signup">
                    <label for="senha">Senha</label>
                    <input type="password" id="senhaCad" name="senhaCad" required>
                </div>
                
                <br><br> 

                <div class="signup-btn">
                    <button type="button" class="login-btn" id="signup-btn">Cadastrar</button>
                </div>
        </div>        
    </div>            
            </form>

            <br><br> 
           
<script>



 const signupBtn= document.getElementById("signup-btn");
 
signupBtn.addEventListener('click',()=>{

 let nome= document.getElementById("nomeCad").value.trim();   
 let cpf= document.getElementById("cpfCad").value;   
 let numero= document.getElementById("numeroCad").value;   
 let nascimento= document.getElementById("nascCad").value;
 let email= document.getElementById("emailCad").value;

//N tem necessidade de tratamento de data aqui(HTML ja entrega em LOCALDATE)
//  nascimentoRaw=String(nascimento);
//  const dia = nascimentoRaw.slice(0,2);
//  const mes = nascimentoRaw.slice(3,5);
//  const ano = nascimentoRaw.slice(6,9);

//  console.log(nascimento);
//  console.log(dia);
//  console.log(mes);
//  console.log(ano);

requisicao = {
    name: nome,
    telefone: numero,
    email: email,
    cpf: cpf,
    nascimento: nascimento
}

const requisicaoJson = JSON.stringify(requisicao,null,2);

fetch('http://localhost:8080/pessoa/criar',{
            method: 'POST',
            headers: {
                   'Content-Type': 'application/json' 
            },
            body:requisicaoJson
        })    .then(response => {
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
    })
    .then(data => {
        console.log('Success:', data);
    }).then(alert("Pessoa cadastrada com Sucesso!"))
    .then(window.location.href='3.telaInicial.html')


});

 
</script>            
</body>
</html>